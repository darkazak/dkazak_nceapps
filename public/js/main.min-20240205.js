function pageLoaded(e){let t=e.document.URL.split("/");if(document.getElementById("msg-flash").value="0","trades"==t[4]&&"lut_item_edit"==t[5]){console.log("loading the lut item edit page");let l=document.getElementById("attributes_array").value;{let a=makeAttributesIntoObj(l).TYPE,n=makeAttributesIntoObj(l).BRAND,i=makeAttributesIntoObj(l).COLOR,s=makeAttributesIntoObj(l).FOCUS_TYPE,r=makeAttributesIntoObj(l).MOUNT,d=makeAttributesIntoObj(l).FOCAL_LENGTH,c=makeAttributesIntoObj(l).MAXIMUM_APERTURE,o=makeAttributesIntoObj(l).FILTER_SIZE,u=makeAttributesIntoObj(l).BATTERY,m=makeAttributesIntoObj(l).CHARGER;isEmpty(a)?(document.getElementById("show_attribute_type").checked=!1,document.getElementById("attribute_type_select").classList.add("visually-hidden")):(document.getElementById("show_attribute_type").checked=!0,document.getElementById("attribute_type_select").classList.remove("visually-hidden")),isEmpty(n)?(document.getElementById("show_attribute_brand").checked=!1,document.getElementById("attribute_brand_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_brand").checked=!0,document.getElementById("attribute_brand_input").classList.remove("visually-hidden")),isEmpty(i)&&(document.getElementById("attribute_color_select").value="NONE"),document.getElementById("show_attribute_color").checked=!0,isEmpty(s)?(document.getElementById("show_attribute_focustype").checked=!1,document.getElementById("attribute_focustype_select").classList.add("visually-hidden")):(document.getElementById("show_attribute_focustype").checked=!0,document.getElementById("attribute_focustype_select").classList.remove("visually-hidden")),isEmpty(r)?(document.getElementById("show_attribute_mount").checked=!1,document.getElementById("attribute_mount_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_mount").checked=!0,document.getElementById("attribute_mount_input").classList.remove("visually-hidden")),isEmpty(d)?(document.getElementById("show_attribute_focallength").checked=!1,document.getElementById("attribute_focallength_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_focallength").checked=!0,document.getElementById("attribute_focallength_input").classList.remove("visually-hidden")),isEmpty(c)?(document.getElementById("show_attribute_maximumaperture").checked=!1,document.getElementById("attribute_maximumaperture_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_maximumaperture").checked=!0,document.getElementById("attribute_maximumaperture_input").classList.remove("visually-hidden")),isEmpty(o)?(document.getElementById("show_attribute_filtersize").checked=!1,document.getElementById("attribute_filtersize_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_filtersize").checked=!0,document.getElementById("attribute_filtersize_input").classList.remove("visually-hidden")),isEmpty(u)?(document.getElementById("show_attribute_battery").checked=!1,document.getElementById("attribute_battery_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_battery").checked=!0,document.getElementById("attribute_battery_input").classList.remove("visually-hidden")),isEmpty(m)?(document.getElementById("show_attribute_charger").checked=!1,document.getElementById("attribute_charger_input").classList.add("visually-hidden")):(document.getElementById("show_attribute_charger").checked=!0,document.getElementById("attribute_charger_input").classList.remove("visually-hidden"));let g=document.getElementById("attribute_type_select").value;checkLensAttributeDisplay(g)}{let y=document.getElementById("categories").value,p=y.split(" > "),E=["cat_set_a","cat_set_b","cat_set_c","cat_set_da","cat_set_db","cat_set_fa","cat_set_fb","cat_set_fc","cat_set_fd","cat_set_g",];document.getElementById("category_display").value=y;for(let h=0;h<p.length;h++)for(let I=0;I<E.length;I++){let v=document.getElementById(E[I]).options;for(let B=0;B<v.length;B++)v[B].innerHTML==p[h]&&(v.selectedIndex=B)}}updatePriceMatrix();return}if("trades"==t[4]&&"add"==t[5]){tradeSheetCalulateTotals();return}if("customers"==t[4]&&"index"==t[5]){void 0!=document.getElementById("dupe_last_name")&&showCustomersResult(document.getElementById("dupe_last_name").value),document.getElementById("navbar_logo").style.cursor="default";return}let b=document.getElementById("msg-flash").value;if("0"!=b){if(console.log("flash message: "+b.innerHTML),b.classList.contains("alert-danger")){console.log("this is a bad alert");let f=document.getElementById("enter_button");f.classList.add("btn-danger")}else console.log("this is a good alert");setTimeout(function e(){var t=1;let l=setInterval(function(){t>0?(t-=.025,b.style.opacity=t):(clearInterval(l),b.style.opacity=0,b.classList.add("visually-hidden"))},85)},2e3),$_SESSION.error_message="0",$_SESSION.error_type="alert",document.getElementById("msg-flash").value="0"}else console.log("no error alerts here")}function showCustomersResult(e){if(e){rawResponse="";let t=document.URL,l=t.split("/");if(l.pop(),l.push("livesearch"),t=l.join("/"),0==e.length){document.getElementById("livesearch").innerHTML="",document.getElementById("livesearch").style.border="0px";return}let a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(rawResponse=this.responseText,console.log("showCustomersResult - rawResponse: ",rawResponse),parsedText=parseAjaxJSONtoSelectClients(rawResponse),document.getElementById("livesearch").innerHTML=parsedText,document.getElementById("livesearch").className="text-light bg-secondary",lineCount=countAjaxDataReturn(rawResponse),document.getElementById("itemcount").innerHTML=lineCount,lineCount<12?document.getElementById("counter").className="text-success":lineCount<50?document.getElementById("counter").className="text-primary":lineCount<100?document.getElementById("counter").className="text-warning":document.getElementById("counter").className="text-danger",document.getElementById("list_found_btn").classList.remove("visually-hidden"),document.getElementById("new_customer_btn").classList.remove("visually-hidden"))},a.open("GET",t+"/"+e,!0),a.send()}else console.log("showCustomersResult - no entry data yet.")}function parseAjaxJSONtoSelectClients(e){let t=JSON.parse(e);for(let l in parsedText="",t){let a=caseNameString(t[l].LName)+", "+caseNameString(t[l].FName);parsedText+='<option value=" &apos;'+t[l].Client_ID.toString()+'&apos;" onclick="confirmFoundCustomer(&apos;'+t[l].Client_ID.toString()+'&apos;)"  >'+a+"</option>"}return parsedText}function listFoundCustomers(){let e=JSON.parse(rawResponse);for(let t in formList="",e){let l=e[t].email.toUpperCase(),a=caseNameString(e[t].LName)+", "+caseNameString(e[t].FName),n=formatPhoneNumber(e[t].phone);formList+='<tr class="row" ><td class="col-2"><input type="button" class="btn btn-info" onclick="confirmFoundCustomer(&apos;'+e[t].Client_ID.toString()+'&apos;)" value="Select"></td><td class="col-3">'+a+'</td><td class="col-2">'+n+'</td><td class="col-3">'+l+'</td><td class="col-2"><input type="button" class="btn btn-danger" onclick="notYetAlert();"value="Update" tabindex="-1"></td></td ></ tr >'}document.getElementById("result_list").innerHTML=formList,document.getElementById("result_table").classList.remove("visually-hidden"),document.getElementById("livesearch").classList.add("visually-hidden"),document.getElementById("list_found_btn").classList.add("visually-hidden")}function confirmFoundCustomer(e){window.location.href="./check_found_customer/"+e}function editCustomerData(e){notYetAlert()}function showItemsResult(e,t="loose"){if(e){let l=(e=e.replace(/ /g,"[]")).replaceAll("%","-|-");l=l.replaceAll("&","@@"),console.log("str: "+e),console.log("cleanStr: "+l),rawResponse="";let a=document.URL,n=a.split("/");if(n.pop(),"strict"==t?n.push("liveSearchStrict"):n.push("liveSearchLoose"),a=n.join("/"),console.log("urlStr: "+a),0==e.length){document.getElementById("livesearch").innerHTML="",document.getElementById("livesearch").style.border="0px";return}let i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(rawResponse=this.responseText,console.log("showItemsResult - rawresponse: "+rawResponse),parsedText=parseAjaxJSONtoSelectItems(rawResponse),document.getElementById("livesearch").innerHTML=parsedText,document.getElementById("livesearch").className="text-light bg-secondary col-12",lineCount=countAjaxDataReturn(rawResponse),document.getElementById("itemcount").innerHTML=lineCount,0==lineCount?(document.getElementById("list_btn").disabled=!0,document.getElementById("livesearch").classList.add("visually-hidden"),document.getElementById("counter").className="text-dark"):lineCount<12?(document.getElementById("counter").className="text-success",document.getElementById("list_btn").disabled=!1):lineCount<50?(document.getElementById("counter").className="text-primary",document.getElementById("list_btn").disabled=!1):lineCount<100?(document.getElementById("counter").className="text-warning",document.getElementById("list_btn").disabled=!1):document.getElementById("counter").className="text-danger")},i.open("POST",a+"/"+l,!0),i.send()}else console.log("showItemsResult - no entry data yet.")}function parseAjaxJSONtoSelectItems(e){let t=JSON.parse(e);for(let l in parsedText="",t){let a=t[l].medium_description;""==!t[l].comments&&(a+=" ("+t[l].comments+")");let n=t[l].trade_lu_id;parsedText+='<option value=" '+n+'" onclick="confirmFoundItem(\''+n+"')\"  >"+a+"</option>"}return parsedText}function listFoundItems(){if(console.log("listFoundItems: rawResponse",rawResponse),"[]"==rawResponse)formList='<tr class="row"><td classs="col-12"><b><i>NO LOOK-UP-TABLE ITEMS TO DISPLAY</i></b></td></tr>';else{let e=JSON.parse(rawResponse);for(let t in console.log("listFoundItems->thisObj: ",Object.keys(e)),formList="",e)formList+='<tr class="row" ><td class="col-1"><input value="Select" type="button" class="btn btn-info btn-sm" onclick="confirmFoundItem(\''+e[t].trade_lu_id+'\')"> </td><td class="col-3">'+e[t].medium_description+'<span class="small text-primary"><br>'+e[t].comments+'</span></td><td class="col-1">'+e[t].minor+'</td><td class="col-2 centered">'+e[t].vsn+'</td><td class="col-1">'+e[t].family+'</td><td class="col-1">'+e[t].trade_lu_id+'</td><td class="col-3 centered"><input value="Edit" type="button" class="btn btn-danger btn-sm" onclick="editFoundItem(\''+e[t].trade_lu_id+'\')" tabindex="-1"> </td ></tr>'}document.getElementById("result_list").innerHTML=formList,document.getElementById("result_table").classList.remove("visually-hidden"),document.getElementById("livesearch").classList.add("visually-hidden"),document.getElementById("new_entry_btn").classList.remove("visually-hidden"),document.getElementById("list_btn").disabled=!0,document.getElementById("show_btn").disabled=!0}function confirmFoundItem(e){window.location.href="./get_add_lut_item_to_trade_sheet/"+e}function editFoundItem(e){alert("Edit Item: "+e+". Feature to come.")}function resetFindForm(){document.getElementById("livesearch").classList.add("visually-hidden"),document.getElementById("counter").classList.add("visually-hidden"),document.getElementById("result_table").classList.add("visually-hidden"),document.getElementById("new_entry_btn").classList.add("visually-hidden"),document.getElementById("searchfield").value="",document.getElementById("list_btn").disabled=!0}function showNewTradeItemBtn(){document.getElementById("new_entry_btn").classList.remove("visually-hidden")}function showHuntResult(e){document.getElementById("result_table").classList.add("visually-hidden"),rawResponse="";let t=document.URL,l=t.split("/");l.pop(),l.push("liveSearchHunt/"+e),t=l.join("/");let a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&200==this.status&&(rawResponse=this.responseText,console.log("showHuntResult, rawresponse: ",rawResponse),displayHuntCount(rawResponse),setHuntForm(e))},a.open("GET",t,!0),a.setRequestHeader("Content-type","application/json"),a.send()}function setHuntForm(e){huntButtons=[];let t=document.URL,l=t.split("/");l.pop(),l.push("hunt_btn_data"),t=l.join("/");let a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let t=JSON.parse(this.responseText);huntButtons=t[e].buttons,backTarget=t[e].backTarget,updateHuntLabel(huntLable=t[e].headline),0==huntButtons.length?listFoundItems():(huntHideAll(),buildHuntPage(e,huntButtons)),""===backTarget?document.getElementById("hunt_back_btn").classList.add("visually-hidden"):document.getElementById("hunt_back_btn").classList.remove("visually-hidden")}},a.open("GET",t,!0),a.setRequestHeader("Content-type","application/json"),a.send()}function buildHuntPage(e="",t=[]){huntPageHtml='<div id="'+e,huntPageHtml+='" class="hunt-page row mt-3"><div class="container"><div class="row"><div class="col">';for(let l=0;l<t.length;l++)"break"==t[l][0]?huntPageHtml+="<br> ":(huntPageHtml+='<a href="#" class="btn ',huntPageHtml+="btn-"+t[l][0]+" ",huntPageHtml+='mt-3 me-2" onclick="showHuntResult(&apos;',huntPageHtml+=t[l][1]+'&apos;)">'+t[l][2]+"</a> ");huntPageHtml+="</div></div></div></div>",document.getElementById("hunt_buttons_array").innerHTML=huntPageHtml}function huntHideAll(){let e=document.getElementById("hunt_buttons_array"),t=e.getElementsByClassName("hunt-page");for(let l=0;l<t.length;l++)document.getElementById(t[l].id).classList.add("visually-hidden");document.getElementById("hunt_back_btn").classList.add("visually-hidden"),resetFindForm()}function huntGoBack(){document.getElementById("hunt_counter").classList.add("visually-hidden"),showHuntResult(backTarget)}function updateHuntLabel(e){document.getElementById("hunt-label").innerHTML=e}function displayHuntCount(e){lineCount=countAjaxDataReturn(e),document.getElementById("hunt_itemcount").innerHTML=lineCount,0==lineCount?(document.getElementById("hunt_counter").className="text-dark",document.getElementById("show_btn").disabled=!0,document.getElementById("hunt_counter").classList.add("visually-hidden")):lineCount<20?(document.getElementById("hunt_counter").className="text-success",document.getElementById("show_btn").disabled=!1):lineCount<50?(document.getElementById("hunt_counter").className="text-primary",document.getElementById("show_btn").disabled=!1):lineCount<110?(document.getElementById("hunt_counter").className="text-warning",document.getElementById("show_btn").disabled=!1):(document.getElementById("hunt_counter").className="text-danger",document.getElementById("show_btn").disabled=!1)}function countAjaxDataReturn(e){let t=JSON.parse(e);return t.length}function calculateEntirePriceMatrix(){console.log("calculateEntirePriceMatrix")}function updateMatrixValue(e,t){console.log("updateMatrixValue - value: "+e),console.log("updateMatrixValue - target: "+t)}function calculateTunerFactor(e,t){let l=1;return 0==(l=1==e?1:e>1?e+t:e-t)&&(l=1),isNaN(l)&&(l=1),Number(l)}function calculateSelectLutItemPriceMatrix(){let e=getFormFieldValue("has_cosmetics"),t=getFormFieldValue("has_opticals"),l=getFormFieldValue("has_mechanicals"),a=Number(getFormFieldValue("cosmetic_condition_selected_value")),n=Number(getFormFieldValue("optical_condition_selected_value")),i=Number(getFormFieldValue("mechanical_condition_selected_value")),s=Number(getFormFieldValue("cosmetic_tune_val")),r=Number(getFormFieldValue("optical_tune_val")),d=Number(getFormFieldValue("mechanical_tune_val")),c=Number(getFormFieldValue("base_price_field")),o=Number(getFormFieldValue("trade_percent")),u=Number(getFormFieldValue("purchase_percent")),m=1,g=1,y=1,p=0,E=0,h=0,I=0,v=0,B=0,b=!1;"on"==e&&(m=calculateTunerFactor(a,s)),"on"==t&&(g=calculateTunerFactor(n,r)),"on"==l&&(y=calculateTunerFactor(i,d)),0==c&&(b=!0,c=document.getElementById("base_price").value),console.log("__________"),console.log("base_price: "+c),console.log("trade_percent: "+o),console.log("purchase_percent: "+u),console.log("__________"),console.log("cosm_calc: "+m),console.log("opti_calc: "+g),console.log("mech_calc: "+y),v=(I=c*m*g*y)*(o/100),B=I*(u/100),console.log("calculated_retail: "+I),console.log("calculated_trade: "+v),console.log("calculated_purchase: "+B),p=I>100?priceToFive(I):priceToCurrent(I),E=v>100?priceToFive(v):priceToCurrent(v),h=B>100?priceToFive(B):priceToCurrent(B),document.getElementById("base_price").value=c.toLocaleString("en-US",{style:"currency",currency:"USD"}),document.getElementById("retail_calc_label").innerHTML=p.toLocaleString("en-US",{style:"currency",currency:"USD"}),document.getElementById("trade_calc_label").innerHTML=E.toLocaleString("en-US",{style:"currency",currency:"USD"}),document.getElementById("purchase_calc_label").innerHTML=h.toLocaleString("en-US",{style:"currency",currency:"USD"}),document.getElementById("retail_price_override").value=p.toLocaleString("en-US",{style:"currency",currency:"USD"}),document.getElementById("trade_price_override").value=E.toLocaleString("en-US",{style:"currency",currency:"USD"}),document.getElementById("purchase_price_override").value=h.toLocaleString("en-US",{style:"currency",currency:"USD"})}function processManualBaseTradePurchaseEntry(){document.getElementById("base_price").value=document.getElementById("base_price_field").value,document.getElementById("trade_percent").value=document.getElementById("trade_percent_field").value,document.getElementById("purchase_percent").value=document.getElementById("purchase_percent_field").value,updatePricingDisplay()}function updateFieldPriceFormat(e,t){let l=Number(t=(t=t.replace("$","")).trim()),a=priceToCurrent(l);document.getElementById(e).value=a.toLocaleString("en-US",{style:"currency",currency:"USD"});document.getElementById("retail_calc_label").innerHTML.includes("NaN")&&(document.getElementById("retail_calc_label").innerHTML="need data");document.getElementById("retail_calc_label").innerHTML.includes("-$0.01")&&(document.getElementById("retail_calc_label").innerHTML="");document.getElementById("retail_price_override").value.includes("NaN")&&(document.getElementById("retail_price_override").value="");document.getElementById("retail_price_override").value.includes("-$0.01")&&(document.getElementById("retail_price_override").value="");document.getElementById("trade_calc_label").innerHTML.includes("NaN")&&(document.getElementById("trade_calc_label").innerHTML="need data");document.getElementById("trade_calc_label").innerHTML.includes("-$0.01")&&(document.getElementById("trade_calc_label").innerHTML="");document.getElementById("trade_price_override").value.includes("NaN")&&(document.getElementById("trade_price_override").value="");document.getElementById("trade_price_override").value.includes("-$0.01")&&(document.getElementById("trade_price_override").value="");document.getElementById("purchase_calc_label").innerHTML.includes("NaN")&&(document.getElementById("purchase_calc_label").innerHTML="need data");document.getElementById("purchase_calc_label").innerHTML.includes("-$0.01")&&(document.getElementById("purchase_calc_label").innerHTML="");document.getElementById("purchase_price_override").value.includes("NaN")&&(document.getElementById("purchase_price_override").value="");document.getElementById("purchase_price_override").value.includes("-$0.01")&&(document.getElementById("purchase_price_override").value="")}function tradeSheetCalulateTotals(){let e=document.querySelectorAll(".retail-line-item"),t=document.querySelectorAll(".trade-line-item"),l=document.querySelectorAll(".purchase-line-item"),a=0;e.forEach(function(e){a+=Number(e.innerHTML)});let n=a.toLocaleString("en-US",{style:"currency",currency:"USD"});document.getElementById("retail_total").innerHTML=n,document.getElementById("retail_total_calc").value=n;let i=0;t.forEach(function(e){i+=Number(e.innerHTML)});let s=i.toLocaleString("en-US",{style:"currency",currency:"USD"});document.getElementById("trade_total").innerHTML=s,document.getElementById("trade_total_calc").value=s;let r=0;l.forEach(function(e){r+=Number(e.innerHTML)});let d=r.toLocaleString("en-US",{style:"currency",currency:"USD"});document.getElementById("purchase_total").innerHTML=d,document.getElementById("purchase_total_calc").value=d,updateTradeTotalDisplay(transaction_flag=document.getElementById("transaction_flag").value)}function updateTradeTotalDisplay(e){let t=document.getElementById("retail_total").innerHTML,l=document.getElementById("trade_total").innerHTML,a=document.getElementById("purchase_total").innerHTML,n=document.querySelectorAll(".trade-line-item"),i=document.querySelectorAll(".purchase-line-item"),s=document.querySelectorAll(".trade-line-label"),r=document.querySelectorAll(".purchase-line-label");transaction_total_display="Not enough data to calculate.",document.getElementById("purchase_transaction").checked&&(transaction_total_display='<span class="text-success">Purchase Transaction<br>Total: '+a+"</span>",transaction_total_display+="<br><br><br>",transaction_total_display+="Retail Amount:<br>"+t,n.forEach(function(e){e.classList.remove("bg-warning"),e.classList.remove("bg-opacity-10"),e.classList.add("text-black-50")}),i.forEach(function(e){e.classList.add("bg-success"),e.classList.add("bg-opacity-10"),e.classList.remove("text-black-50")}),s.forEach(function(e){e.classList.remove("bg-warning"),e.classList.remove("bg-opacity-50"),e.classList.add("text-black-50")}),r.forEach(function(e){e.classList.add("bg-success"),e.classList.add("bg-opacity-50"),e.classList.add("text-success"),e.classList.remove("text-black-50")})),document.getElementById("trade_transaction").checked&&(transaction_total_display='<span class="text-warning">Trade Transaction<br>Total: '+l+"</span>",transaction_total_display+="<br><br><br>",transaction_total_display+="Retail Amount:<br>"+t,n.forEach(function(e){e.classList.add("bg-warning"),e.classList.add("bg-opacity-10"),e.classList.remove("text-black-50")}),i.forEach(function(e){e.classList.remove("bg-success"),e.classList.remove("bg-opacity-10"),e.classList.add("text-black-50")}),s.forEach(function(e){e.classList.add("bg-warning"),e.classList.add("bg-opacity-50"),e.classList.remove("text-black-50")}),r.forEach(function(e){e.classList.remove("bg-success"),e.classList.remove("bg-opacity-50"),e.classList.remove("text-success"),e.classList.add("text-black-50")})),document.getElementById("quote_transaction").checked&&(transaction_total_display='Quote Only<br><span class="text-warning">Trade: '+l+'</span><br><span class="text-success">purchase: '+a+"</span>",transaction_total_display+="<br><br>",transaction_total_display+="Retail Amount:<br>"+t,n.forEach(function(e){e.className="trade-line-item",e.classList.add("bg-warning"),e.classList.add("bg-opacity-10")}),i.forEach(function(e){e.className="purchase-line-item",e.classList.add("bg-success"),e.classList.add("bg-opacity-10")}),s.forEach(function(e){e.className="trade-line-label",e.classList.add("bg-warning"),e.classList.add("bg-opacity-50"),e.classList.add("text-dark")}),r.forEach(function(e){e.className="purchase-line-label",e.classList.add("bg-success"),e.classList.add("bg-opacity-50"),e.classList.add("text-dark")})),document.getElementById("transaction_total_display_field").innerHTML=transaction_total_display,document.getElementById("transaction_flag").value=e,setTradeRadioButtons(e)}function updateRefPrice(e){console.log("target field: "+e);let t=document.getElementById("retail_calc").value;console.log("price_entry: "+t);let l=t.replace(/[$,]+/g,"");console.log("price_entry_num: "+l),l>0?(console.log("do it"),document.getElementById(e).value=t):console.log("no base price data")}function loadDefaultPricingMatrix(e){console.log("loadDefaultPricingMatrix, this_val: ",e);let t=document.URL,l=t.split("/");l.pop(),l.push("minor_codes_default_price_matrix_data"),t=l.join("/");let a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState&&200==this.status){console.log("loadDefaultPricingMatrix - rawResponse ","");let t=JSON.parse(this.responseText);console.log("jsonObj[this_val]: ",t[e]),updateFormFieldValue("trade_percent_entry",t[e]["pricing-matrix"]["trade-percent"]),updateFormFieldValue("purchase_percent_entry",t[e]["pricing-matrix"]["purchase-percent"]);let l=t[e]["pricing-matrix"].cosmetic.relevant,a=t[e]["pricing-matrix"].mechanical.relevant,n=t[e]["pricing-matrix"].optical.relevant;updateFormFieldValue("cosmetic_condition_tuner",t[e]["pricing-matrix"].cosmetic.tuner),updateFormFieldValue("mechanical_condition_tuner",t[e]["pricing-matrix"].mechanical.tuner),updateFormFieldValue("optical_condition_tuner",t[e]["pricing-matrix"].optical.tuner),updateFormFieldValue("cosmetic_conditon_factor_mint",t[e]["pricing-matrix"].cosmetic.mint),updateFormFieldValue("cosmetic_conditon_factor_nearmint",t[e]["pricing-matrix"].cosmetic.nearmint),updateFormFieldValue("cosmetic_conditon_factor_excellent",t[e]["pricing-matrix"].cosmetic.excellent),updateFormFieldValue("cosmetic_conditon_factor_verygood",t[e]["pricing-matrix"].cosmetic.verygood),updateFormFieldValue("cosmetic_conditon_factor_average",t[e]["pricing-matrix"].cosmetic.average),updateFormFieldValue("cosmetic_conditon_factor_fair",t[e]["pricing-matrix"].cosmetic.fair),updateFormFieldValue("cosmetic_conditon_factor_poor",t[e]["pricing-matrix"].cosmetic.poor),updateFormFieldValue("mechanical_conditon_factor_operational",t[e]["pricing-matrix"].mechanical.operational),updateFormFieldValue("mechanical_conditon_factor_minordefect",t[e]["pricing-matrix"].mechanical.minordefect),updateFormFieldValue("mechanical_conditon_factor_majordefect",t[e]["pricing-matrix"].mechanical.majordefect),updateFormFieldValue("mechanical_conditon_factor_parts",t[e]["pricing-matrix"].mechanical.parts),updateFormFieldValue("optical_conditon_factor_mint",t[e]["pricing-matrix"].optical.mint),updateFormFieldValue("optical_conditon_factor_nearmint",t[e]["pricing-matrix"].optical.nearmint),updateFormFieldValue("optical_conditon_factor_excellent",t[e]["pricing-matrix"].optical.excellent),updateFormFieldValue("optical_conditon_factor_verygood",t[e]["pricing-matrix"].optical.verygood),updateFormFieldValue("optical_conditon_factor_average",t[e]["pricing-matrix"].optical.average),updateFormFieldValue("optical_conditon_factor_fair",t[e]["pricing-matrix"].optical.fair),updateFormFieldValue("optical_conditon_factor_poor",t[e]["pricing-matrix"].optical.poor),l?(document.getElementById("cosmetic_dropdown_set").classList.remove("visually-hidden"),document.getElementById("cosmetic_condition_dropdown_switch").classList.remove("visually-hidden")):(document.getElementById("cosmetic_pricing_set").classList.add("visually-hidden"),document.getElementById("cosmetic_condition_dropdown_set").classList.remove("visually-hidden"),document.getElementById("cosmetic_condition_dropdown_switch_label").innerHTML="Show Cosmetic Condition Selector",document.getElementById("cosmetic_condition_dropdown_switch_check").classList.remove("visually-hidden")),n?(document.getElementById("optical_dropdown_set").classList.remove("visually-hidden"),document.getElementById("optical_condition_dropdown_switch").classList.remove("visually-hidden")):(document.getElementById("optical_dropdown_set").classList.add("visually-hidden"),document.getElementById("optical_condition_dropdown_switch").classList.remove("visually-hidden"),document.getElementById("optical_condition_dropdown_switch_label").innerHTML="Show Optical Condition Selector",document.getElementById("optical_condition_dropdown_switch_check").classList.remove("visually-hidden")),a?(document.getElementById("mechanical_dropdown_set").classList.remove("visually-hidden"),document.getElementById("mechanical_condition_dropdown_switch").classList.remove("visually-hidden")):(document.getElementById("mechanical_dropdown_set").classList.add("visually-hidden"),document.getElementById("mechanical_condition_dropdown_switch").classList.remove("visually-hidden"),document.getElementById("mechanical_condition_dropdown_switch_label").innerHTML="Show Optical Condition Selector",document.getElementById("mechanical_condition_dropdown_switch_check").classList.remove("visually-hidden"))}},a.open("GET",t,!0),a.setRequestHeader("Content-type","application/json"),a.send()}function selectCondition(e){let t=e.split("_"),l=document.getElementById(e).options[document.getElementById(e).selectedIndex].text,a=document.getElementById(e).options[document.getElementById(e).selectedIndex].value,n=t[0]+"_"+t[1]+"_selected_text";document.getElementById(n).value=l,cond_targ=t[0]+"_"+t[1]+"_selected_value",isNaN(a)||(document.getElementById(cond_targ).value=a);let i=getFormFieldValue("has_cosmetics"),s=getFormFieldValue("cosmetic_condition_selected_value"),r=getFormFieldValue("has_opticals"),d=getFormFieldValue("optical_condition_selected_value"),c=getFormFieldValue("has_mechanicals"),o=getFormFieldValue("mechanical_condition_selected_value");1==i&&(cosmetic_condition_dropdown_entry=document.getElementById("cosmetic_condition_dropdown").options[document.getElementById("cosmetic_condition_dropdown").selectedIndex].text),1==r&&(optical_condition_dropdown_entry=document.getElementById("optical_condition_dropdown").options[document.getElementById("optical_condition_dropdown").selectedIndex].text),1==c&&(mechanical_condition_dropdown_entry=document.getElementById("mechanical_condition_dropdown").options[document.getElementById("mechanical_condition_dropdown").selectedIndex].text),"Parts Only"==mechanical_condition_dropdown_entry?console.log("manual entry only!"):("Select One"==cosmetic_condition_dropdown_entry&&(s="unset",document.getElementById("cosmetic_condition_selected_value").value="unset"),"Select One"==optical_condition_dropdown_entry&&(d="unset",document.getElementById("optical_condition_selected_value").value="unset"),"Select One"==mechanical_condition_dropdown_entry&&(o="unset",document.getElementById("mechanical_condition_selected_value").value="unset"),console.log("-----"),console.log("cosmetic_condition_visible ",i),console.log("cosmetic_condition_factor ",s),console.log("cosmetic_condition_dropdown_entry ",cosmetic_condition_dropdown_entry),console.log("-----"),console.log("optical_condition_visible ",r),console.log("optical_condition_factor ",d),console.log("optical_condition_dropdown_entry ",optical_condition_dropdown_entry),console.log("-----"),console.log("mechanical_condition_visible ",c),console.log("mechanical_condition_factor ",o),console.log("mechanical_condition_dropdown_entry ",mechanical_condition_dropdown_entry),updatePricingDisplay())}function updatePricingDisplay(){console.log("-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_"),console.log("updatePricingDisplay function");let e=!1,t=!1,l=!1,a=!1,n=0,i=0,s=!1,r=!1,d=!1,c=getFormFieldValue("has_cosmetics"),o=getFormFieldValue("cosmetic_condition_selected_value"),u=getFormFieldValue("has_opticals"),m=getFormFieldValue("optical_condition_selected_value"),g=getFormFieldValue("has_mechanicals"),y=getFormFieldValue("mechanical_condition_selected_value");c&&(n++,"unset"==o?t=!1:(t=!0,i=Number(i)+Number(o))),u&&(n++,"unset"==m?l=!1:(l=!0,i=Number(i)+Number(m))),g&&(n++,"unset"==y?a=!1:(a=!0,i=Number(i)+Number(y)));let p=document.getElementById("base_price").value,E=document.getElementById("trade_percent").value,h=document.getElementById("purchase_percent").value;if(0!=p&&(s=!0),0!=E&&(r=!0),0!=h&&(d=!0),a&&l&&t&&s&&r&&d&&(e=!0),e){let I=(p*(i/n)).toFixed(2),v=(p*(E/100)).toFixed(2),B=(p*(h/100)).toFixed(2);console.log("---------------------------------------------------"),console.log("all_conditions_set: "+e),console.log("denominator: "+n),console.log("numerator: "+i),console.log("base price: "+p),console.log("trade factor: "+E),console.log("purchase factor: "+h),console.log("retail_price: "+I),console.log("trade_price: "+v),console.log("purchase_price: "+B),console.log("---------------------------------------------------"),document.getElementById("retail_calc_label").innerHTML="$"+I,document.getElementById("retail_price_override").value="$"+I,document.getElementById("trade_calc_label").innerHTML="$"+v,document.getElementById("trade_price_override").value="$"+v,document.getElementById("purchase_calc_label").innerHTML="$"+B,document.getElementById("purchase_price_override").value="$"+B}else document.getElementById("retail_calc_label").innerHTML="need data",document.getElementById("trade_calc_label").innerHTML="need data",document.getElementById("purchase_calc_label").innerHTML="need data"}function switchOpticalConditionSelector(e){!1==e?(document.getElementById("optical_condition_true_btn").classList.add("visually-hidden"),document.getElementById("optical_condition_dropdown_set").classList.add("visually-hidden"),document.getElementById("optical_condition_dropdown_set").tabIndex=-1,document.getElementById("optical_condition_false_btn").classList.remove("visually-hidden"),document.getElementById("optical_condition_selected_value").value="unset",document.getElementById("optical_condition_selected_text").value="",document.getElementById("has_opticals").value=0):(document.getElementById("optical_condition_true_btn").classList.remove("visually-hidden"),document.getElementById("optical_condition_dropdown_set").classList.remove("visually-hidden"),document.getElementById("optical_condition_dropdown_set").tabIndex=0,document.getElementById("optical_condition_false_btn").classList.add("visually-hidden"),document.getElementById("has_opticals").value=1,document.getElementById("optical_condition_dropdown").value=document.getElementById("optical_condition_selected_value").value)}function switchMechanicalConditionSelector(e){!1==e?(document.getElementById("mechanical_condition_true_btn").classList.add("visually-hidden"),document.getElementById("mechanical_condition_dropdown_set").classList.add("visually-hidden"),document.getElementById("mechanical_condition_dropdown_set").tabIndex=-1,document.getElementById("mechanical_condition_false_btn").classList.remove("visually-hidden"),document.getElementById("mechanical_condition_selected_value").value="unset",document.getElementById("mechanical_condition_selected_text").value="",document.getElementById("has_mechanicals").value=0):(document.getElementById("mechanical_condition_true_btn").classList.remove("visually-hidden"),document.getElementById("mechanical_condition_dropdown_set").classList.remove("visually-hidden"),document.getElementById("mechanical_condition_dropdown_set").tabIndex=0,document.getElementById("mechanical_condition_false_btn").classList.add("visually-hidden"),document.getElementById("has_mechanicals").value=1,document.getElementById("mechanical_condition_dropdown").value=document.getElementById("mechanical_condition_selected_value").value)}function confirmTradeItem(){console.log("fired the confirm trade funtion"),showFlashMessage(["<ul><li>Checking form input</li><li>Forwarding to nect page, PHP GET</li></ul>"])}function addTradeItemBtn(){window.location.href="trades/continue"}function newTradeItemBtn(){window.location.href="./trade_item_new"}function editTradeItem(e){console.log("editTradeItem: ",e)}function editTradeLutItemBtn(){console.log(`pages load data: ${document.URL} `);let e=document.URL.split("/");lut_item_id=document.getElementById("lut_item_id").value,console.log(`lut_item_id: ${lut_item_id} `),""!=lut_item_id?(edit_url=e[0]+"//"+e[2]+"/"+e[3]+"/trades/lut_item_edit/"+lut_item_id,console.log("good to go"),window.location.href=edit_url):showFlashMessage(["Please enter a LUT Item ID Number to continue."])}function printTradeForCustomer(){document.getElementById("print_type").value="customer",document.getElementById("print_data").submit()}function printTradeForStore(){document.getElementById("print_type").value="store",document.getElementById("print_data").submit()}function setTradeRadioButtons(e){switch(e){case"purchase_transaction":document.getElementById("quote_transaction_label").classList.add("bg-opacity-25"),document.getElementById("quote_transaction_label").classList.remove("bg-opacity-75"),document.getElementById("quote_transaction_label").classList.add("text-primary"),document.getElementById("quote_transaction_label").classList.remove("text-dark"),document.getElementById("trade_transaction_label").classList.remove("bg-opacity-75"),document.getElementById("trade_transaction_label").classList.add("bg-opacity-25"),document.getElementById("trade_transaction_label").classList.remove("text-dark"),document.getElementById("trade_transaction_label").classList.add("text-warning"),document.getElementById("purchase_transaction_label").classList.add("bg-opacity-75"),document.getElementById("purchase_transaction_label").classList.remove("bg-opacity-25"),document.getElementById("purchase_transaction_label").classList.add("text-dark"),document.getElementById("purchase_transaction_label").classList.remove("text-success");break;case"trade_transaction":document.getElementById("quote_transaction_label").classList.add("bg-opacity-25"),document.getElementById("quote_transaction_label").classList.remove("bg-opacity-75"),document.getElementById("quote_transaction_label").classList.add("text-primary"),document.getElementById("quote_transaction_label").classList.remove("text-dark"),document.getElementById("trade_transaction_label").classList.add("bg-opacity-75"),document.getElementById("trade_transaction_label").classList.remove("bg-opacity-25"),document.getElementById("trade_transaction_label").classList.add("text-dark"),document.getElementById("trade_transaction_label").classList.remove("text-warning"),document.getElementById("purchase_transaction_label").classList.remove("bg-opacity-75"),document.getElementById("purchase_transaction_label").classList.add("bg-opacity-25"),document.getElementById("purchase_transaction_label").classList.remove("text-dark"),document.getElementById("purchase_transaction_label").classList.add("text-success");break;default:document.getElementById("quote_transaction_label").classList.remove("bg-opacity-25"),document.getElementById("quote_transaction_label").classList.add("bg-opacity-75"),document.getElementById("quote_transaction_label").classList.remove("text-primary"),document.getElementById("quote_transaction_label").classList.add("text-dark"),document.getElementById("trade_transaction_label").classList.remove("bg-opacity-75"),document.getElementById("trade_transaction_label").classList.add("bg-opacity-25"),document.getElementById("trade_transaction_label").classList.remove("text-dark"),document.getElementById("trade_transaction_label").classList.add("text-warning"),document.getElementById("purchase_transaction_label").classList.remove("bg-opacity-75"),document.getElementById("purchase_transaction_label").classList.add("bg-opacity-25"),document.getElementById("purchase_transaction_label").classList.remove("text-dark"),document.getElementById("purchase_transaction_label").classList.add("text-success")}}function checkEbay(e){let t=e.replace(/ /gi,"+");console.log("item_url_str: "+t),window.open("https://www.ebay.com/sch/i.html?_from=R40&_nkw="+t+"&_sacat=0&LH_TitleDesc=0&LH_BIN=1&LH_PrefLoc=1&LH_Complete=1&LH_Sold=1&LH_ItemCondition=3000&rt=nc&LH_AS=1","_blank")}function returnToLastPage(){window.history.back()}function clickUp(e){targ_element=document.getElementById(e);let t=document.getElementById("base_price_entry").value,l=t.length,a=.1;l<=2?a=5:3==l&&(a=1),newValue=(newNum=parseFloat(targ_element.value)+a)<100?newNum>0?newNum.toFixed(2):0:100,targ_element.value=newValue}function clickDown(e){targ_element=document.getElementById(e);let t=document.getElementById("base_price_entry").value,l=t.length,a=.1;l<=2?a=5:3==l&&(a=1),newValue=(newNum=parseFloat(targ_element.value)-a)<100?newNum>0?newNum.toFixed(2):0:100,targ_element.value=newValue}function updatePercentage(){updatePriceMatrix()}function updateBasePrice(){document.getElementById("base_price_value").value=document.getElementById("base_price_entry").value,updatePriceMatrix()}function afterClickPercent(e){updatePriceMatrix()}function afterClickCondition(e){}function updatePriceMatrix(){console.log("running updatePriceMatrix"),document.getElementById("base_price_value").value=document.getElementById("base_price_entry").value,document.getElementById("trade_percent_value").value=document.getElementById("trade_percent_entry").value,document.getElementById("purchase_percent_value").value=document.getElementById("purchase_percent_entry").value;let e=parseFloat(document.getElementById("base_price_value").value),t=parseFloat(document.getElementById("trade_percent_value").value),l=parseFloat(document.getElementById("purchase_percent_value").value),a=parseFloat(document.getElementById("cosmetic_condition_selected_value").value),n=parseFloat(document.getElementById("cosmetic_condition_tuner_value").value),i=parseFloat(document.getElementById("optical_condition_selected_value").value),s=parseFloat(document.getElementById("optical_condition_tuner_value").value),r=parseFloat(document.getElementById("mechanical_condition_selected_value").value),d=parseFloat(document.getElementById("mechanical_condition_tuner_value").value);if(e>0&&t>0&&l>0){let c=0,o=0,u=0,m=0;1==document.getElementById("has_cosmetics_value").value?(c=calculateTunerFactor(a,n),m++):c=0,1==document.getElementById("has_opticals_value").value?(o=calculateTunerFactor(i,s),m++):o=0,1==document.getElementById("has_mechanicals_value").value?(u=calculateTunerFactor(r,d),m++):u=0;let g=e*((c+o+u)/m),y=priceToFive(g),p=priceToFive(g*(t/100)),E=priceToFive(g*(l/100));document.getElementById("retail_calc").value=formatCurrency(y),document.getElementById("trade_calc").value=formatCurrency(p),document.getElementById("purchase_calc").value=formatCurrency(E),document.getElementById("retail_price_value").value=y,document.getElementById("trade_price_value").value=p,document.getElementById("purchase_price_value").value=E}else console.log("missing data")}function clickClicker(e){let t=e.classList[1].split("-")[2],l=e.parentElement.parentElement.childNodes[1];updateConditionMatrixDisplay(l);let a=document.getElementById(l.id).value,n=0;n="up"==t?Number(a)+.01:Number(a)-.01,document.getElementById(l.id).value=n.toFixed(2),updatePriceMatrix()}function clickPercentClicker(e){}function fillMediumDescription(){document.getElementById("medium_description").value=document.getElementById("short_description").value,characterCounter("medium_description")}function fillLongDescription(){document.getElementById("long_description").value=document.getElementById("medium_description").value,characterCounter("long_description")}function characterCounter(e){let t=document.getElementById(e).value.length,l=0,a=0,n=0,i="text-success small";switch(e){case"long_description":l=255,a=25,n=16;break;case"medium_description":l=80,a=19,n=8;break;case"short_description":l=30,a=10,n=5;break;default:l=0,a=0,n=0}let s=l-t;i=s<=1?"text-danger small":s<=n?"text-warning small":s<=a?"text-primary small":"text-success small",document.getElementById(e+"_char_count").innerHTML='<p class="'+i+'">'+t+" of "+l+"</p>"}function enterUpdatedMediumDescription(e,t){let l=document.getElementById("medium_description_entry").value.toUpperCase();console.log("enterUpdatedMediumDescription - this_entry: "+e),console.log("enterUpdatedMediumDescription - found_text: "+t),console.log("enterUpdatedMediumDescription - start_text: "+l),document.getElementById("medium_description_entry").value=l.slice(0,l.lastIndexOf(t))+e,document.getElementById("medium_description_livesearch").classList.add("visually-hidden"),document.getElementById("medium_description_livesearch").innerHTML="",document.getElementById("medium_description_entry").focus()}function setSerialNumToNone(){this_field=document.getElementById("serial_num"),this_field_label=document.getElementById("serial_num_label"),!0==this_field.disabled?(this_field.disabled=!1,this_field.vaule="",this_field_label.innerHTML="Serial Number"):(this_field.disabled=!0,this_field.vaule="no serial number",this_field_label.innerHTML="no serial number")}function updateItemTitle(e){document.getElementById("item-header").innerHTML=e,document.getElementById("item-header-sub").innerHTML=e}function formatEntryFloat(e,t){let l=Number(t);l<0&&(l=0);let a=l.toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});document.getElementById(e).value=a}function clearMatrixDisplay(e){let t=document.getElementById("menu_"+e);for(let l=0;l<t.options.length;l++)document.getElementById(t.options[l].value+"_entry").classList.remove("border","border-3","border-primary","shadow-2-strong","bg-primary","bg-opacity-10")}function formatMatrixField(e){document.getElementById(e).classList.add("border","border-3","border-primary","shadow-2-strong","bg-primary","bg-opacity-10")}function updateDropdownDisplay(e){let t=e.split("_");t[1],t[1],t[2]}function updateConditionDropDownEntryDisplay(e){let t=document.getElementById(e.id).value.split("_");clearMatrixDisplay(t[1]);let l=t[0]+"_"+t[1]+"_"+t[2]+"_entry";formatMatrixField(l),updateHiddenConditionSelectionValue(l)}function toggleCondtionDropdown(e){let t=e.split("_"),l=e,a=e+"_label",n=t[0]+"_"+t[2]+"_set",i=t[0]+"_"+t[1]+"_"+t[2],s=t[0].replace(t[0].slice(0,1),t[0].slice(0,1).toUpperCase());document.getElementById(n).classList.contains("visually-hidden")?(document.getElementById(n).classList.remove("visually-hidden"),document.getElementById(a).innerHTML="Hide "+s+" Condition Selector",document.getElementById(l).checked=!0,document.getElementById(i).focus()):(document.getElementById(n).classList.add("visually-hidden"),document.getElementById(a).innerHTML="Show "+s+" Condition Selector",document.getElementById(l).checked=!1,document.getElementById(l).blur())}function updateConditonDropdown(e){id_arr=e.split("_"),document.getElementById("menu_"+id_arr[1]).value="condition_"+id_arr[1]+"_"+id_arr[2]}function updateConditionMatrixDisplay(e){console.log("updateConditionMatrixDisplay: "+e.id);let t=e.id.split("_");clearMatrixDisplay(t[1]),formatMatrixField(e.id),updateConditonDropdown(e.id),updateHiddenConditionSelectionValue(e.id)}function XXXXupdateConditionEntryFieldMatrix(e){}function updateHiddenConditionSelectionValue(e){console.log("selected_matrix_id: "+e);let t=e.split("_"),l=document.getElementById(e),a=l.value;console.log("this_value: "+a);let n=t[1]+"_condition_selected_value";document.getElementById(n).value=a,updatePriceMatrix()}function updateSlider(e,t){let l=Number(t).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}),a=e.replace("slider","entry"),n=e.replace("slider","value");document.getElementById(a).value=l,document.getElementById(n).value=l,updatePriceMatrix()}function updateSliderEntry(e,t){let l=e.split("_"),a=l[0]+"_"+l[1]+"_"+l[2]+"_value",n=l[0]+"_"+l[1]+"_"+l[2]+"_slider",i=Number(t).toLocaleString("en-US",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2});document.getElementById(a).value=i,document.getElementById(n).value=i,updatePriceMatrix()}function liveUpdateItemHeaderComment(e){this_entry=(title_entry=document.getElementById("medium_description_entry").value)+" <span class='small'>("+e+")</span>",document.getElementById("item_header").innerHTML=this_entry}function liveUpdateMediumDescription(e){if("Shift"==e||"Control"==e||"Alt"==e||"Meta"==e);else{let t=JSON.parse(document.getElementById("name_data_translation_array").value),l=document.getElementById("medium_description_entry").value,a=(l=(l=l.toUpperCase()).trim()).lastIndexOf(" "),n=l.length,i=l.slice(a,n).trim(),s=Object.keys(t).length,r="";try{let d=RegExp("^("+i+").*$","i");for(let c=0;c<s;c++)d.test(t[c][0])&&(r+='<option value=" &apos;'+t[c][0]+'&apos;" onclick="enterUpdatedMediumDescription(&apos;'+t[c][0]+"&apos;&comma;&apos;"+i+'&apos;)">'+t[c][0]+"</option>")}catch(o){r=""}""==r?document.getElementById("medium_description_livesearch").classList.add("visually-hidden"):(document.getElementById("medium_description_livesearch").innerHTML=r,document.getElementById("medium_description_livesearch").classList.remove("visually-hidden"),document.getElementById("medium_description_livesearch").className="text-light bg-secondary")}}function updateGersTitle(){let e=document.getElementById("name_data_translation_array").value,t=JSON.parse(e),l=document.getElementById("medium_description_entry").value.toUpperCase(),a=Object.keys(t).length;for(let n=0;n<a;n++){let i=t[n][0],s=t[n][1];i=i.toUpperCase(),s=s.toUpperCase(),l=l.replaceAll(i,s)}document.getElementById("item_title_entry").value=l,document.getElementById("item_title-character_count").innerHTML=l.length,l.length>30?(document.getElementById("item_title_entry").disabled=!1,document.getElementById("item_title_entry").classList.add("text-light","bg-danger")):(document.getElementById("item_title_entry").classList.remove("text-light","bg-danger"),document.getElementById("item_title_entry").disabled=!0),document.getElementById("item_title").value=l}function liveUpdateGersTitle(){test_term=document.getElementById("item_title_entry").value,document.getElementById("item_title_entry").value=test_term.toUpperCase(),console.log("test term length: "+test_term.length),document.getElementById("item_title-character_count").innerHTML=test_term.length,test_term.length>30?document.getElementById("item_title_entry").classList.add("text-light","bg-danger"):document.getElementById("item_title_entry").classList.remove("text-light","bg-danger"),document.getElementById("item_title").value=test_term}function toggleLutEditPricingSection(e){let t=e.id.split("_"),l=t[1],a=document.getElementById(l+"_condition_factors_div").querySelectorAll(".form-control");if(e.checked){document.getElementById("condition_"+l+"_dropdown_example").classList.remove("visually-hidden"),document.getElementById(l+"_condition_tuner_value").value=document.getElementById("cosmetic_condition_tuner_entry").value;for(var n=0;n<a.length;n++){let i=a[n].id,s=i.replace("entry","value");document.getElementById(s).value=document.getElementById(i).value}document.getElementById("has_"+l+"s_value").value="1",document.getElementById("lut_"+l+"_pricing_matrix_section_label").classList.remove("text-dark"),document.getElementById("lut_"+l+"_pricing_matrix_section_label").classList.add("text-primary"),document.getElementById(l+"_condition_factors_div").classList.remove("visually-hidden")}else{document.getElementById("condition_"+l+"_dropdown_example").classList.add("visually-hidden"),document.getElementById(l+"_condition_factors_div").classList.add("visually-hidden"),document.getElementById(l+"_condition_tuner_value").value="0";for(var n=0;n<a.length;n++){let r=a[n].id.replace("entry","value");document.getElementById(r).value="0"}document.getElementById("has_"+l+"s_value").value="0",document.getElementById("lut_"+l+"_pricing_matrix_section_label").classList.remove("text-primary"),document.getElementById("lut_"+l+"_pricing_matrix_section_label").classList.add("text-dark")}updatePriceMatrix()}function toggleAttributesSection(){let e=document.getElementById("all_attributes_rows");e.classList.contains("visually-hidden")?(document.getElementById("all_attributes_toggle_button").value="Hide",document.getElementById("all_attributes_toggle_button_icon").innerHTML="&dtrif;",e.classList.remove("visually-hidden")):(document.getElementById("all_attributes_toggle_button").value="Show",document.getElementById("all_attributes_toggle_button_icon").innerHTML="&rtrif;",e.classList.add("visually-hidden"))}function makeAttributesIntoObj(e){return JSON.parse(e)}function updateAttributesInJSON(e,t){switch(jsonAttributeObject=JSON.parse(document.getElementById("attributes_array").value),e=e.toUpperCase()){case"TYPE":jsonAttributeObject.TYPE=t.toUpperCase();break;case"BRAND":jsonAttributeObject.BRAND=t.toUpperCase();break;case"COLOR":jsonAttributeObject.COLOR=t.toUpperCase();break;case"FOCUSTYPE":jsonAttributeObject.FOCUS_TYPE=t.toUpperCase();break;case"MOUNT":jsonAttributeObject.MOUNT=t.toUpperCase();break;case"FOCALLENGTH":jsonAttributeObject.FOCAL_LENGTH=t.toUpperCase();break;case"MAXIMUMAPERTURE":jsonAttributeObject.MAXIMIM_APERTURE=t.toUpperCase();break;case"FILTERSIZE":jsonAttributeObject.FILTER_SIZE=t.toUpperCase();break;case"BATTERY":jsonAttributeObject.BATTERY=JSON.parse(t);break;case"CHARGER":jsonAttributeObject.CHARGER=JSON.parse(t)}updatedJsonAttributeString=JSON.stringify(jsonAttributeObject),document.getElementById("attributes_array").value=updatedJsonAttributeString}function cleanHiddenAttributesField(){let e=JSON.parse(document.getElementById("attributes_array").value);document.getElementById("show_attribute_type").checked||delete e.TYPE,document.getElementById("show_attribute_brand").checked||delete e.BRAND,document.getElementById("show_attribute_color").checked||delete e.COLOR,document.getElementById("show_attribute_focustype").checked||delete e.FOCUS_TYPE,document.getElementById("show_attribute_mount").checked||delete e.MOUNT,document.getElementById("show_attribute_focallength").checked||delete e.FOCAL_LENGTH,document.getElementById("show_attribute_maximumaperture").checked||delete e.MAXIMUM_APERTURE,document.getElementById("show_attribute_filtersize").checked||delete e.FILTER_SIZE,document.getElementById("show_attribute_battery").checked||delete e.BATTERY,document.getElementById("show_attribute_charger").checked||delete e.CHARGER;let t=JSON.stringify(e);document.getElementById("attributes_array").value=t}function toggleAttributeEntry(e,t){if(this_item_array=e.id.split("_"),e.checked){"both"==t?(document.getElementById(this_item_array[1]+"_"+this_item_array[2]+"_select").classList.remove("visually-hidden"),document.getElementById(this_item_array[1]+"_"+this_item_array[2]+"_input").classList.add("visually-hidden")):document.getElementById(this_item_array[1]+"_"+this_item_array[2]+"_"+t).classList.remove("visually-hidden");let l=this_item_array[2],a="NONE";try{a=document.getElementById("attribute_"+l+"_select").value}catch(n){a=document.getElementById("attribute_"+l+"_input").value}updateAttributesInJSON(l,a)}else"both"==t?(document.getElementById(this_item_array[1]+"_"+this_item_array[2]+"_select").classList.add("visually-hidden"),document.getElementById(this_item_array[1]+"_"+this_item_array[2]+"_input").classList.add("visually-hidden")):document.getElementById(this_item_array[1]+"_"+this_item_array[2]+"_"+t).classList.add("visually-hidden"),cleanHiddenAttributesField()}function XXXXresetTypeAttributePicker(){}function checkColorEntry(e){console.log("checking the color selection: "+e),"OTHER"==e?(document.getElementById("attribute_color_select").classList.add("visually-hidden"),document.getElementById("attribute_color_input").classList.remove("visually-hidden")):(document.getElementById("attribute_color_select").classList.remove("visually-hidden"),document.getElementById("attribute_color_input").classList.add("visually-hidden"))}function removeBattery(e){document.getElementById("attribute_battery_input_"+e).value="",document.getElementById("attribute_battery_row_"+e).classList.add("visually-hidden"),updateBatteryList()}function removeCharger(e){document.getElementById("attribute_charger_input_"+e).value="",document.getElementById("attribute_charger_row_"+e).classList.add("visually-hidden"),updateChargerList()}function addBatteryEntry(){let e=document.getElementById("battery_rows_container").children.length;console.log("this is the current count: "+e),parent_id=e-1;let t="attribute_battery_row_"+parent_id;console.log("this is the parent: "+t);let l='<div id="attribute_battery_row_'+e+'" class="row">';l+='<div class="col-11">',l+='<input type="text" class="form-control border border-1 border-primary text-uppercase" id="attribute_battery_input_'+e+'"',l+=' value="" placeholder="Enter Battery" name="attribute_battery_input_'+e+'" onblur="updateBatteryList();"></div><div class="col-1 m-0 p-0 mt-1"><span class="text-primary cursor-pointer" href="#" onmouseup="removeBattery('+e+')">&Otimes;</span></div>',l+="</div>",console.log(l),document.getElementById(t).insertAdjacentHTML("afterend",l),document.getElementById("attribute_battery_input_"+e).setSelectionRange(0,0),document.getElementById("attribute_battery_input_"+e).focus()}function addChargerEntry(){let e=document.getElementById("charger_rows_container").children.length;parent_id=e-1;let t="attribute_charger_row_"+parent_id,l='<div id="attribute_charger_row_'+e+'" class="row">';l+='<div class="col-11">',l+='<input type="text" class="form-control border border-1 border-primary text-uppercase" id="attribute_charger_input_'+e+'"',l+=' value="" placeholder="Enter Charger" name="attribute_charger_input_'+e+'" onblur="updateChargerList();"></div><div class="col-1 m-0 p-0 mt-1"><span class="text-primary cursor-pointer" href="#" onmouseup="removeCharger('+e+')">&Otimes;</span></div>',l+="</div>",document.getElementById(t).insertAdjacentHTML("afterend",l),document.getElementById("attribute_charger_input_"+e).setSelectionRange(0,0)}function toggleBatteryEntry(){show_attribute_battery.checked?showBatteryEntry():hideBatteryEntry()}function toggleChargerEntry(){show_attribute_charger.checked?showChargerEntry():hideChargerEntry()}function showBatteryEntry(){document.getElementById("attribute_battery_input").classList.remove("visually-hidden")}function showChargerEntry(){document.getElementById("attribute_charger_input").classList.remove("visually-hidden")}function hideBatteryEntry(){document.getElementById("attribute_battery_input").classList.add("visually-hidden")}function hideChargerEntry(){document.getElementById("attribute_charger_input").classList.add("visually-hidden")}function checkLensAttributeDisplay(e){let t=["COMPACT DIGITAL CAMERA","COMPACT FILM CAMERA","INSTANT FILM CAMERA","CAMCORDER","MOVIE CAMERA","LENS","LENS ADAPTOR","LENS MEDIUM AND LARGE FORMAT","MIRRORLESS LENS","RANGEFINDER LENS","BELLOWS","FINDER","FILTER",],l=!1;for(let a=0;a<t.length;a++)t[a]==e&&(l=!0);l?document.getElementById("lens_attribute_row").classList.remove("visually-hidden"):document.getElementById("lens_attribute_row").classList.add("visually-hidden")}function updateBatteryList(){console.log("updateBatteryList");let e=document.getElementById("battery_rows_container").children.length,t=0,l=[];for(let a=0;a<e;a++){let n=document.getElementById("attribute_battery_input_"+a).value;!isEmpty(n)&&(l.push(n.toUpperCase()),t++)}let i=JSON.stringify(l);console.log("charger_arr_string: "+i),updateAttributesInJSON("BATTERY",i)}function updateChargerList(){console.log("updateChargerList");let e=document.getElementById("charger_rows_container").children.length,t=0,l=[];for(let a=0;a<e;a++){let n=document.getElementById("attribute_charger_input_"+a).value;!isEmpty(n)&&(l.push(n.toUpperCase()),t++)}let i=JSON.stringify(l);console.log("charger_arr_string: "+i),updateAttributesInJSON("CHARGER",i)}function toggleCategoriesSection(){let e=document.getElementById("all_categories_rows");e.classList.contains("visually-hidden")?(document.getElementById("all_categories_toggle_button").value="Hide",document.getElementById("all_categories_toggle_button_icon").innerHTML="&dtrif;",e.classList.remove("visually-hidden")):(document.getElementById("all_categories_toggle_button").value="Show",document.getElementById("all_categories_toggle_button_icon").innerHTML="&rtrif;",e.classList.add("visually-hidden"))}function updateCategory(){let e=["cat_set_a","cat_set_b","cat_set_c","cat_set_da","cat_set_db","cat_set_fa","cat_set_fb","cat_set_fc","cat_set_fd","cat_set_g",],t="",l=document.getElementById("cat_set_a"),a=l.options.selectedIndex;l[a].innerHTML,a&&(t=l[a].innerHTML);for(let n=1;n<e.length;n++){let i=document.getElementById(e[n]).options,s=i.selectedIndex,r=i[s].innerHTML;s&&(t+=" > ",t+=r)}document.getElementById("categories").value=t,document.getElementById("category_display").value=t}function toggleManualCategoryEntry(){let e=document.getElementById("manual_category_entry_switch").checked;e?(document.getElementById("category_display").disabled=!1,document.getElementById("category_display").classList.remove("bg-light-grey-2")):(document.getElementById("category_display").disabled=!0,document.getElementById("category_display").classList.add("bg-light-grey-2"))}function updateManualCategoryEntry(e){document.getElementById("categories").value=e}function confirmLUTUpdate(){document.getElementById("update_lut_item").submit()}function setLocationSwitch(){document.getElementById("location_switch").value="1"}function setAlertButton(e,t="Are you sure?",l="Yes",a="No"){let n="";if(""!=e){console.log("target_page: "+e);let i=getURLRoot();console.log("root_url: "+i),n=i+e,console.log("full_url: "+n)}alertWindow(n,t,l,a)}function fireAlertButton(e){""!=e&&pageLoad(e)}function alertWindow(e,t,l,a){let n=document.getElementById("myModal"),i=document.getElementById("modal-yes-button"),s=document.getElementById("modal-no-button");i.value=l,s.value=a,document.getElementById("modal-message").innerHTML=t,n.style.display="block",i.onmouseup=function(){n.style.display="none",fireAlertButton(e)},""==a&&(s.style.display="none"),s.onmouseup=function(){n.style.display="none"},n.onmouseup=function(){n.style.display="none"},window.onmouseup=function(e){e.target==n&&(n.style.display="none")}}function checkAppSecurity(){let e=document.getElementById("secure_app_pasword").value;console.log("secure_app_passsword: "+secure_app_passsword),console.log("this_pass_attempt: "+e),console.log("URLRoot: "+getURLRoot()),e==secure_app_passsword?pageLoad(getURLRoot()+"/pages/secure_session"):setAlertButton("","Incorrect Password","Try Again","")}function notYetAlert(){setAlertButton("","Feature Not Yet Implemented","Okay","")}function showFlashMessage(e){let t=document.getElementById("msg-flash");t.innerHTML=e,t.classList.remove("visually-hidden")}function numRound(e){return Math.round(e)}function priceToFive(e){return 5*Math.round(e/5)-.01}function priceToCurrent(e){return Math.round(e)-.01}function caseNameString(e){return e.substr(0,1).toUpperCase()+e.substr(1,e.length).toLowerCase()}function formatPhoneNumber(e){let t=(""+e).replace(/\D/g,"");if(10==e.length){var l=t.match(/^(\d{3})(\d{3})(\d{4})$/);if(l)var a="("+l[1]+") "+l[2]+"-"+l[3];else var a=e}else if(11==e.length){let n=t.match(/(^[1])(\d{3})(\d{3})(\d{4})$/);if(n)n[1],n[2],n[3],n[4];else var a=e}else a=e;return a}function formatCurrencyClean(e){return Number(e.replace(/,/g,"")).toLocaleString("en-US",{style:"decimal"})}function formatCurrency(e){return e.toLocaleString("en-US",{style:"currency",currency:"USD"})}function formatStringtoCurrency(e){e.id;let t=e.value;t=t.replace("$","");let l=Number(t),a=formatCurrency(l);e.value=a}function makeValueUpperCase(e){let t=e.value,l=t.toUpperCase();document.getElementById(e.id).value=l}function logVariable(e,t){console.log(`${e}: ${t}`)}function updateFormFieldValue(e,t){if(void 0===e){console.log("ERROR: updateFormFieldValue error, the field id is undefined");return}if(void 0===t){console.log("ERROR: updateFormFieldValue error, the inesert data is undefined");return}document.getElementById(e).value=t,document.getElementById(e).focus(),document.getElementById(e).blur()}function getFormFieldValue(e){let t=document.getElementById(e).value;return t}function pageClose(){window.close()}function pageLoad(e){window.open(e,"_self")}function selectText(e){document.getElementById(e).select()}function getURLRoot(){let e=window.location.href,t=e.indexOf(set_app_dir),l=e.slice(0,t);return l+=set_app_dir,e}function toggle_visible(e){let t=document.getElementById(e);t.classList,console.log("this_element.classList: "+t.classList),t.classList.contains("visually-hidden")?t.classList.remove("visually-hidden"):t.classList.add("visually-hidden")}function isEmpty(e){return""==e||void 0==e||null==e}